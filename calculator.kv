<Windows>
    id: calculator
    display: entry
    historyID: history


    FloatLayout:
        pos: 0, 0
        size: root.width , root.height

        canvas.before:
            Color:
                rgba: .11, .11, .086, 1
            Rectangle:
                pos: self.pos
                size: self.size

        GridLayout:
            rows:2
            padding: dp(20), dp(50), dp(20), dp(10)
            size_hint: 1, 1
            TextInput:
                id: entry
                font_size: sp(root.width*0.09)
                size_hint: 1, 0.20
                multiline: False
                readonly: True
                spacing: dp(10)
                adoptive_size: True
                base_direction: "rtl"


            GridLayout:
                rows:5
                spacing: dp(-15)

                BoxLayout:
                    pos_hint: {'center_y':0.5}
                    spacing: dp(10)
                    adoptive_size: True

                    Button:
                        font_size: sp(30)
                        text: "AC"
                        on_press: entry.text = ""
                        size_hint: .25, .75
                        theme_text_color: "Custom"
                        text_color: 1, 1, 1, 1
                        line_color: 0, 0, 0, 0
                        background_color: .51 , .51, .51, 1


                    Button:
                        font_size: sp(30)
                        size_hint: .25, .75
                        theme_text_color: "Custom"
                        text_color: 1, 1, 1, 1
                        line_color: 0, 0, 0, 0
                        background_color: .51 , .51, .51, 1
                        on_press:
                            list = entry.text[:-1]
                            entry.text = list
                        Image:
                            source:"backspace.png"
                            size: dp(30), dp(30)
                            keep_ratio: False
                            center_x: self.parent.center_x
                            center_y: self.parent.center_y


                    Button:
                        font_size: sp(30)
                        text: "%"
                        on_press:entry.text += self.text
                        size_hint: .25, .75
                        theme_text_color: "Custom"
                        text_color: 1, 1, 1, 1
                        line_color: 0, 0, 0, 0
                        background_color: .51 , .51, .51, 1

                    Button:
                        font_size: sp(30)
                        text: "/"
                        on_press:entry.text += self.text
                        size_hint: .25, .75
                        theme_text_color: "Custom"
                        text_color: 1, 1, 1, 1
                        line_color: 0, 0, 0, 0
                        background_color: .51 , .51, .51, 1

                BoxLayout:
                    pos_hint: {'center_y':0.5}
                    spacing: dp(10)
                    adoptive_size: True

                    Button:
                        size_hint: .25, .75
                        theme_text_color: "Custom"
                        text_color: 1, 1, 1, 1
                        line_color: 0, 0, 0, 0
                        background_color: 1 , 1, 1, 1
                        font_size: sp(30)
                        text: "7"
                        on_press:entry.text += self.text

                    Button:
                        size_hint: .25, .75
                        theme_text_color: "Custom"
                        text_color: 1, 1, 1, 1
                        line_color: 0, 0, 0, 0
                        background_color: 1, 1, 1, 1
                        font_size: sp(30)
                        text: "8"
                        on_press:entry.text += self.text

                    Button:
                        size_hint: .25, .75
                        theme_text_color: "Custom"
                        text_color: 1, 1, 1, 1
                        line_color: 0, 0, 0, 0
                        background_color: 1, 1, 1, 1
                        font_size: sp(30)
                        text: "9"
                        on_press:entry.text += self.text

                    Button:
                        size_hint: .25, .75
                        theme_text_color: "Custom"
                        text_color: 1, 1, 1, 1
                        line_color: 0, 0, 0, 0
                        background_color: .51 , .51, .51, 1
                        font_size: sp(30)
                        text: "*"
                        on_press:entry.text += self.text

                BoxLayout:
                    spacing: dp(10)

                    Button:

                        size_hint: .25, .75
                        theme_text_color: "Custom"
                        text_color: 1, 1, 1, 1
                        line_color: 0, 0, 0, 0
                        background_color: 1, 1, 1, 1
                        font_size: sp(30)
                        text: "4"
                        on_press:entry.text += self.text

                    Button:

                        size_hint: .25, .75
                        theme_text_color: "Custom"
                        text_color: 1, 1, 1, 1
                        line_color: 0, 0, 0, 0
                        background_color: 1, 1, 1, 1
                        font_size: sp(30)
                        text: "5"
                        on_press:entry.text += self.text

                    Button:
                        size_hint: .25, .75
                        theme_text_color: "Custom"
                        text_color: 1, 1, 1, 1
                        line_color: 0, 0, 0, 0
                        background_color: 1, 1, 1, 1
                        font_size: sp(30)
                        text: "6"
                        on_press:entry.text += self.text

                    Button:
                        size_hint: .25, .75
                        theme_text_color: "Custom"
                        text_color: 1, 1, 1, 1
                        line_color: 0, 0, 0, 0
                        background_color: .51 , .51, .51, 1
                        font_size: sp(30)
                        text: "-"
                        on_press:entry.text += self.text
                BoxLayout:
                    spacing: dp(10)

                    Button:
                        size_hint: .25, .75
                        theme_text_color: "Custom"
                        text_color: 1, 1, 1, 1
                        line_color: 0, 0, 0, 0
                        background_color: 1, 1, 1, 1
                        font_size: sp(30)
                        text: "1"
                        on_press:entry.text += self.text

                    Button:
                        size_hint: .25, .75
                        theme_text_color: "Custom"
                        text_color: 1, 1, 1, 1
                        line_color: 0, 0, 0, 0
                        background_color: 1, 1, 1, 1
                        font_size: sp(30)
                        text: "2"
                        on_press:entry.text += self.text

                    Button:
                        size_hint: .25, .75
                        theme_text_color: "Custom"
                        text_color: 1, 1, 1, 1
                        line_color: 0, 0, 0, 0
                        background_color: 1, 1, 1, 1
                        font_size: sp(30)
                        text: "3"
                        on_press:entry.text += self.text

                    Button:
                        size_hint: .25, .75
                        theme_text_color: "Custom"
                        text_color: 1, 1, 1, 1
                        line_color: 0, 0, 0, 0
                        background_color: .51 , .51, .51, 1
                        font_size: sp(30)
                        text: "+"
                        on_press:entry.text += self.text

                BoxLayout:
                    spacing: dp(10)

                    Button:
                        size_hint: .25, .75
                        theme_text_color: "Custom"
                        text_color: 1, 1, 1, 1
                        line_color: 0, 0, 0, 0
                        background_color: 1, 1, 1, 1
                        id: history
                        font_size: sp(0)
                        on_press: entry.text = history.text
                        Image:
                            source:"history.png"
                            size: dp(30), dp(30)
                            center_x: self.parent.center_x
                            center_y: self.parent.center_y

                    Button:
                        size_hint: .25, .75
                        theme_text_color: "Custom"
                        text_color: 1, 1, 1, 1
                        line_color: 0, 0, 0, 0
                        background_color: 1, 1, 1, 1
                        font_size: sp(30)
                        text: "0"
                        on_press:entry.text += self.text

                    Button:
                        size_hint: .25, .75
                        theme_text_color: "Custom"
                        text_color: 1, 1, 1, 1
                        line_color: 0, 0, 0, 0
                        background_color: 1, 1, 1, 1
                        font_size: sp(30)
                        text: "."
                        on_press:entry.text += self.text

                    Button:
                        size_hint: .25, .75
                        theme_text_color: "Custom"
                        text_color: 1, 1, 1, 1
                        line_color: 0, 0, 0, 0
                        background_color: .909 , .903, 1.728, 1
                        font_size: sp(30)
                        text: "="
                        on_press:
                            calculator.calculate(entry.text)
                            calculator.retrieve(entry.text)
